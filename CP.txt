-- =============================================
-- Advanced Aimbot System (Roblox Lua)
-- =============================================

-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- Variables
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera
local Enabled = false
local Smoothness = 0.5
local FOV = 100
local TeamCheck = false
local VisibleCheck = true

-- GUI Setup
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local LeftPanel = Instance.new("Frame")
local Logo = Instance.new("ImageLabel")
local TabButtons = Instance.new("ScrollingFrame")
local SettingsPanel = Instance.new("Frame")
local Title = Instance.new("TextLabel")

ScreenGui.Parent = game:GetService("CoreGui") -- Use Player.PlayerGui for in-game testing
ScreenGui.Name = "AimbotMenu"

-- Main Window
MainFrame.Size = UDim2.new(0, 600, 0, 400)
MainFrame.Position = UDim2.new(0.5, -300, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Parent = ScreenGui

-- Left Panel (Tabs)
LeftPanel.Size = UDim2.new(0, 150, 0, 400)
LeftPanel.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
LeftPanel.Parent = MainFrame

-- Logo (Replace with your Image ID)
Logo.Size = UDim2.new(0, 100, 0, 50)
Logo.Position = UDim2.new(0.5, -50, 0, 10)
Logo.Image = "rbxassetid://12345678" -- Change this
Logo.Parent = LeftPanel

-- Tab Buttons
TabButtons.Size = UDim2.new(0, 150, 0, 300)
TabButtons.Position = UDim2.new(0, 0, 0, 70)
TabButtons.BackgroundTransparency = 1
TabButtons.ScrollBarThickness = 5
TabButtons.Parent = LeftPanel

local Tabs = {"Aimbot", "Triggerbot", "ESP", "Settings"}

for i, tabName in ipairs(Tabs) do
    local TabButton = Instance.new("TextButton")
    TabButton.Size = UDim2.new(0, 140, 0, 30)
    TabButton.Position = UDim2.new(0, 5, 0, (i-1)*35)
    TabButton.Text = tabName
    TabButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    TabButton.Parent = TabButtons

    TabButton.MouseButton1Click:Connect(function()
        Title.Text = tabName .. " Settings"
        -- Load relevant settings (to be expanded)
    end)
end

-- Settings Panel (Right Side)
SettingsPanel.Size = UDim2.new(0, 450, 0, 400)
SettingsPanel.Position = UDim2.new(0, 150, 0, 0)
SettingsPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
SettingsPanel.Parent = MainFrame

Title.Size = UDim2.new(0, 200, 0, 30)
Title.Position = UDim2.new(0.5, -100, 0, 10)
Title.Text = "Aimbot Settings"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Parent = SettingsPanel

-- =============================================
-- Aimbot Functionality
-- =============================================

local function GetClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local humanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
            local humanoid = player.Character:FindFirstChild("Humanoid")
            
            if humanoidRootPart and humanoid and humanoid.Health > 0 then
                if TeamCheck and player.Team == LocalPlayer.Team then
                    continue
                end

                local screenPoint, onScreen = Camera:WorldToViewportPoint(humanoidRootPart.Position)
                local distance = (humanoidRootPart.Position - LocalPlayer.Character.HumanoidRootPart.Position).Magnitude

                if onScreen then
                    if VisibleCheck then
                        local raycastParams = RaycastParams.new()
                        raycastParams.FilterDescendantsInstances = {LocalPlayer.Character, player.Character}
                        local raycastResult = workspace:Raycast(
                            Camera.CFrame.Position,
                            humanoidRootPart.Position - Camera.CFrame.Position,
                            raycastParams
                        )
                        if raycastResult and raycastResult.Instance:IsDescendantOf(player.Character) then
                            if distance < shortestDistance then
                                closestPlayer = player
                                shortestDistance = distance
                            end
                        end
                    else
                        if distance < shortestDistance then
                            closestPlayer = player
                            shortestDistance = distance
                        end
                    end
                end
            end
        end
    end

    return closestPlayer
end

-- Toggle Aimbot
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.KeyCode == Enum.KeyCode.Q then -- Change keybind here
        Enabled = not Enabled
        print("Aimbot: " .. (Enabled and "ON" or "OFF"))
    end
end)

-- Smooth Aiming
RunService.RenderStepped:Connect(function()
    if Enabled then
        local target = GetClosestPlayer()
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local targetPosition = target.Character.HumanoidRootPart.Position
            local cameraPosition = Camera.CFrame.Position
            local direction = (targetPosition - cameraPosition).Unit

            -- Smooth aiming
            local currentLook = Camera.CFrame.LookVector
            local newLook = currentLook:Lerp(direction, Smoothness)
            Camera.CFrame = CFrame.new(cameraPosition, cameraPosition + newLook)
        end
    end
end)

-- =============================================
-- Triggerbot (Auto-Shoot)
-- =============================================
local function Triggerbot()
    local target = GetClosestPlayer()
    if target and target.Character then
        local head = target.Character:FindFirstChild("Head")
        if head then
            local screenPoint, onScreen = Camera:WorldToViewportPoint(head.Position)
            if onScreen then
                -- Simulate mouse click (requires proper exploit backend)
                -- This is a placeholder and won't work in vanilla Roblox
                print("Triggerbot: Firing at " .. target.Name)
            end
        end
    end
end

-- =============================================
-- ESP (Player Highlight)
-- =============================================
local function CreateESP(player)
    local character = player.Character or player.CharacterAdded:Wait()
    local highlight = Instance.new("Highlight")
    highlight.Parent = character
    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
    highlight.FillTransparency = 0.8
end

Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        CreateESP(player)
    end)
end)

for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        CreateESP(player)
    end
end

print("Advanced Aimbot System Loaded!")